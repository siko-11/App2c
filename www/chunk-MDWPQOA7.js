import{a as f}from"./chunk-HUS6YHHP.js";import{$ as J,A as T,C as G,M,N as O,Q as z,S as A,T as N,U as V,V as H,W as L,X as R,Y as U,Z as $,_ as D,a as E,aa as W,b as I,ba as q,c as y,d as P,e as w,f as c,g as p,h as j,i as _,ia as K,j as d,k as n,ka as Q,l as r,la as X,m as u,n as B,o as m,oa as Y,p as g,r as s,ra as Z,s as v,t as h,ta as tt,y as F,z as k}from"./chunk-7JSJLXP4.js";import"./chunk-7CBVZGVG.js";import"./chunk-CHK7ZTV7.js";import"./chunk-FIRK2ZPN.js";import"./chunk-BK2SWOBY.js";import"./chunk-W2DKFL3W.js";import"./chunk-GFAQE7C7.js";import"./chunk-4U6PRYVA.js";import"./chunk-NDXL6NHI.js";import"./chunk-JWIEPCRG.js";import"./chunk-C5RQ2IC2.js";import"./chunk-D4VGNZLR.js";import"./chunk-JHLW7V75.js";import"./chunk-SV7S5NYR.js";import{a as x,b,f as S}from"./chunk-RW4GY4BD.js";var et=(()=>{let i=class i{constructor(t,e){this.servG=t,this.http=e}get_productos(){let t=this.servG.URLSERV+"productos";return this.http.get(t)}};i.\u0275fac=function(e){return new(e||i)(I(f),I(G))},i.\u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();function at(o,i){if(o&1&&(n(0,"ion-badge",10),s(1),r()),o&2){let l=g();c(),v(l.cantidadCarrito)}}function ct(o,i){if(o&1){let l=B();n(0,"ion-col",11)(1,"ion-card"),u(2,"img",12),n(3,"ion-card-header")(4,"ion-card-title"),s(5),r(),n(6,"ion-card-subtitle"),s(7),r()(),n(8,"ion-card-content")(9,"p")(10,"strong"),s(11,"Precio:"),r(),s(12),r(),n(13,"p")(14,"strong"),s(15,"Stock:"),r(),s(16),r(),n(17,"ion-button",13),m("click",function(){let e=y(l).$implicit,a=g();return P(a.agregarAlCarrito(e))}),s(18," Agregar al carrito "),r()()()()}if(o&2){let l=i.$implicit,t=g();c(2),d("src",t.servG.imagenUrl(l.prod_imagen),w),c(3),v(l.prod_nombre),c(2),h("C\xF3digo: ",l.prod_codigo,""),c(5),h(" $",l.prod_precio,""),c(4),h(" ",l.prod_stock,"")}}var gt=(()=>{let i=class i{constructor(t,e,a,C){this.loading=t,this.servC=e,this.servG=a,this.navCtrl=C,this.listaproductos=[],this.productosFiltrados=[],this.textoBuscar="",this.carrito=[],this.cantidadCarrito=0}ngOnInit(){this.obtenerCarrito()}ionViewWillEnter(){this.cargarProductos()}cargarProductos(){return S(this,null,function*(){let t=yield this.loading.create();t.present(),this.servC.get_productos().subscribe({next:e=>{this.listaproductos=e.data,this.filtrarProductos(),t.dismiss()},error:()=>{t.dismiss(),this.servG.fun_Mensaje("Error al recuperar los productos")}})})}filtrarProductos(){let t=this.textoBuscar.toLowerCase();this.productosFiltrados=this.listaproductos.filter(e=>e.prod_nombre.toLowerCase().includes(t))}agregarAlCarrito(t){let e=this.carrito.findIndex(a=>a.prod_codigo===t.prod_codigo);e!==-1?this.carrito[e].cantidad+=1:this.carrito.push(b(x({},t),{cantidad:1})),this.guardarCarrito(),this.contarCarrito(),this.servG.fun_Mensaje("Producto agregado al carrito")}guardarCarrito(){localStorage.setItem("carrito",JSON.stringify(this.carrito))}obtenerCarrito(){let t=localStorage.getItem("carrito");this.carrito=t?JSON.parse(t):[],this.contarCarrito()}contarCarrito(){this.cantidadCarrito=this.carrito.reduce((t,e)=>t+e.cantidad,0)}irAlCarrito(){this.navCtrl.navigateForward("/carrito")}actualizarTextoBuscar(t){this.textoBuscar=t.detail.value||"",this.filtrarProductos()}};i.\u0275fac=function(e){return new(e||i)(p(Y),p(et),p(f),p(O))},i.\u0275cmp=j({type:i,selectors:[["app-catalogo"]],decls:15,vars:5,consts:[[3,"translucent"],["slot","start"],["defaultHref","principal"],["slot","end"],[3,"click"],["name","cart-outline"],["color","danger",4,"ngIf"],[3,"fullscreen"],["placeholder","Buscar producto...",3,"ionInput","value"],["size","6",4,"ngFor","ngForOf"],["color","danger"],["size","6"],["alt","",2,"width","100%","height","auto",3,"src"],["expand","full","color","primary",3,"click"]],template:function(e,a){e&1&&(n(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),s(3,"Cat\xE1logo"),r(),n(4,"ion-buttons",1),u(5,"ion-back-button",2),r(),n(6,"ion-buttons",3)(7,"ion-button",4),m("click",function(){return a.irAlCarrito()}),u(8,"ion-icon",5),_(9,at,2,1,"ion-badge",6),r()()()(),n(10,"ion-content",7)(11,"ion-searchbar",8),m("ionInput",function(it){return a.actualizarTextoBuscar(it)}),r(),n(12,"ion-grid")(13,"ion-row"),_(14,ct,19,5,"ion-col",9),r()()()),e&2&&(d("translucent",!0),c(9),d("ngIf",a.cantidadCarrito>0),c(),d("fullscreen",!0),c(),d("value",a.textoBuscar),c(3),d("ngForOf",a.productosFiltrados))},dependencies:[tt,U,q,T,F,k,M,X,Q,V,z,N,Z,A,J,W,K,D,H,R,L,$],encapsulation:2});let o=i;return o})();export{gt as CatalogoPage};
