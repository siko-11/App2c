import{a as C}from"./chunk-5VTTDAOW.js";import{A as rt,B as nt,C as at,E as ct,G as st,b as z,c as R,d as U,e as D,f as J,g as $,h as q,i as K,j as Q,l as X,m as Y,n as Z,o as tt,p as et,x as it,y as ot}from"./chunk-QFENY27U.js";import"./chunk-PFJRT2TD.js";import"./chunk-ZUD6CBX5.js";import"./chunk-HNNBZF6L.js";import"./chunk-DYZFNGCR.js";import"./chunk-HC6MZPB3.js";import"./chunk-IP3IRUG3.js";import"./chunk-DXHA4IBJ.js";import"./chunk-RMJ7PCZJ.js";import"./chunk-7KXXZ5W4.js";import"./chunk-3537T4CH.js";import"./chunk-UNHUYKWX.js";import"./chunk-MCRJI3T3.js";import"./chunk-5VHT2D3M.js";import"./chunk-UP7NLS5G.js";import"./chunk-GNOVVPTF.js";import"./chunk-BAKMWPBW.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import{B as d,C as a,D as o,E as m,I as B,J as g,K as h,Na as V,Oa as L,Ra as H,S as s,Sa as W,T as x,U as f,V as F,W as k,X as T,ba as G,ca as N,d as E,ea as A,f as I,ga as O,j as w,k as P,q as M,r as c,s as p,u as j,y as v}from"./chunk-433AV7YM.js";import"./chunk-7KXC3Z5D.js";import"./chunk-FG5LD4HX.js";import"./chunk-NWPDKS2D.js";import"./chunk-45GAR437.js";import"./chunk-GFAQE7C7.js";import"./chunk-ILEDPWO7.js";import"./chunk-JWIEPCRG.js";import"./chunk-C5RQ2IC2.js";import"./chunk-SV7S5NYR.js";import{a as b,b as S,f as y}from"./chunk-RW4GY4BD.js";var lt=(()=>{let i=class i{constructor(t,e){this.servG=t,this.http=e}get_productos(){let t=this.servG.URLSERV+"productos";return this.http.get(t)}};i.\u0275fac=function(e){return new(e||i)(I(C),I(O))},i.\u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();function mt(r,i){if(r&1&&(a(0,"ion-badge",10),s(1),o()),r&2){let l=h();c(),x(l.cantidadCarrito)}}function gt(r,i){if(r&1){let l=B();a(0,"ion-col",11)(1,"ion-card"),m(2,"img",12),a(3,"ion-card-header")(4,"ion-card-title"),s(5),o(),a(6,"ion-card-subtitle"),s(7),o()(),a(8,"ion-card-content")(9,"p")(10,"strong"),s(11,"Precio:"),o(),s(12),o(),a(13,"p")(14,"strong"),s(15,"Stock:"),o(),s(16),o(),a(17,"ion-button",13),g("click",function(){let e=w(l).$implicit,n=h();return P(n.agregarAlCarrito(e))}),s(18," Agregar al carrito "),o()()()()}if(r&2){let l=i.$implicit,t=h();c(2),d("src",t.servG.imagenUrl(l.prod_imagen),M),c(3),x(l.prod_nombre),c(2),f("C\xF3digo: ",l.prod_codigo,""),c(5),f(" $",l.prod_precio,""),c(4),f(" ",l.prod_stock,"")}}var bt=(()=>{let i=class i{constructor(t,e,n,u){this.loading=t,this.servC=e,this.servG=n,this.navCtrl=u,this.listaproductos=[],this.productosFiltrados=[],this.textoBuscar="",this.carrito=[],this.cantidadCarrito=0}ngOnInit(){this.obtenerCarrito()}ionViewWillEnter(){this.cargarProductos()}cargarProductos(){return y(this,null,function*(){let t=yield this.loading.create();t.present(),this.servC.get_productos().subscribe({next:e=>{this.listaproductos=e.data,this.filtrarProductos(),t.dismiss()},error:()=>{t.dismiss(),this.servG.fun_Mensaje("Error al recuperar los productos")}})})}filtrarProductos(){let t=this.textoBuscar.toLowerCase();this.productosFiltrados=this.listaproductos.filter(e=>e.prod_nombre.toLowerCase().includes(t))}agregarAlCarrito(t){let e=this.carrito.findIndex(n=>n.prod_codigo===t.prod_codigo);e!==-1?this.carrito[e].cantidad+=1:this.carrito.push(S(b({},t),{cantidad:1})),this.guardarCarrito(),this.contarCarrito(),this.servG.fun_Mensaje("Producto agregado al carrito")}guardarCarrito(){localStorage.setItem("carrito",JSON.stringify(this.carrito))}obtenerCarrito(){let t=localStorage.getItem("carrito");this.carrito=t?JSON.parse(t):[],this.contarCarrito()}contarCarrito(){this.cantidadCarrito=this.carrito.reduce((t,e)=>t+e.cantidad,0)}irAlCarrito(){this.navCtrl.navigateForward("/carrito")}};i.\u0275fac=function(e){return new(e||i)(p(ct),p(lt),p(C),p(W))},i.\u0275cmp=j({type:i,selectors:[["app-catalogo"]],decls:15,vars:5,consts:[[3,"translucent"],["slot","start"],["defaultHref","principal"],["slot","end"],[3,"click"],["name","cart-outline"],["color","danger",4,"ngIf"],[3,"fullscreen"],["placeholder","Buscar producto...",3,"ngModelChange","ionInput","ngModel"],["size","6",4,"ngFor","ngForOf"],["color","danger"],["size","6"],["alt","",2,"width","100%","height","auto",3,"src"],["expand","full","color","primary",3,"click"]],template:function(e,n){e&1&&(a(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),s(3,"Cat\xE1logo"),o(),a(4,"ion-buttons",1),m(5,"ion-back-button",2),o(),a(6,"ion-buttons",3)(7,"ion-button",4),g("click",function(){return n.irAlCarrito()}),m(8,"ion-icon",5),v(9,mt,2,1,"ion-badge",6),o()()()(),a(10,"ion-content",7)(11,"ion-searchbar",8),T("ngModelChange",function(_){return k(n.textoBuscar,_)||(n.textoBuscar=_),_}),g("ionInput",function(){return n.filtrarProductos()}),o(),a(12,"ion-grid")(13,"ion-row"),v(14,gt,19,5,"ion-col",9),o()()()),e&2&&(d("translucent",!0),c(9),d("ngIf",n.cantidadCarrito>0),c(),d("fullscreen",!0),c(),F("ngModel",n.textoBuscar),c(3),d("ngForOf",n.productosFiltrados))},dependencies:[st,R,U,D,J,$,q,K,Q,X,Y,Z,tt,et,it,ot,rt,nt,z,at,A,G,N,H,V,L],encapsulation:2});let r=i;return r})();export{bt as CatalogoPage};
